<Window x:Class="ProjectManager.FundingTracker"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:DVC="clr-namespace:System.Windows.Controls.DataVisualization.Charting;assembly=System.Windows.Controls.DataVisualization.Toolkit"
        xmlns:scm="clr-namespace:System.ComponentModel;assembly=WindowsBase"
        xmlns:viewModels="clr-namespace:ProjectManager.ViewModels"
        xmlns:Model="clr-namespace:ProjectManager.Model"
        xmlns:local="clr-namespace:ProjectManager"
        xmlns:System ="clr-namespace:System;assembly=mscorlib"
        xmlns:Visualization="clr-namespace:System.Windows.Controls.DataVisualization;assembly=System.Windows.Controls.DataVisualization.Toolkit"
        xmlns:Primitives="clr-namespace:System.Windows.Controls.DataVisualization.Charting.Primitives;assembly=System.Windows.Controls.DataVisualization.Toolkit"
        Title="Funding Tracker" Background="#FF413F42">

    <Window.Resources>
        
        <Model:CurrencyConverter x:Key="CurrencyConverter"/>
        <Model:PercentageConverter x:Key="PercentageConverter"/>
        <Model:DateConverter x:Key="DateConverter"/>

        <CollectionViewSource x:Key="cvGridData" Source="{Binding Path=GridData}">
            <CollectionViewSource.SortDescriptions>
                <scm:SortDescription PropertyName="MIPRnum"/>
            </CollectionViewSource.SortDescriptions>
            <CollectionViewSource.GroupDescriptions>
                <PropertyGroupDescription PropertyName="MIPRnum" x:Name="MIPRgroup"/>
            </CollectionViewSource.GroupDescriptions>
        </CollectionViewSource>
        <CollectionViewSource x:Key="cvTDLData" Source="{Binding Path=TrackedTDLs}">
            <CollectionViewSource.SortDescriptions>
                <scm:SortDescription PropertyName="Contract"/>
            </CollectionViewSource.SortDescriptions>
            <CollectionViewSource.GroupDescriptions>
                <PropertyGroupDescription PropertyName="Contract" x:Name="Contractgroup"/>
            </CollectionViewSource.GroupDescriptions>
        </CollectionViewSource>
        <CollectionViewSource x:Key="cvFundData" Source="{Binding Path=TrackedProjNums}">
            <CollectionViewSource.SortDescriptions>
                <scm:SortDescription PropertyName="MIPRnum"/>
            </CollectionViewSource.SortDescriptions>
            <CollectionViewSource.GroupDescriptions>
                <PropertyGroupDescription PropertyName="MIPRnum" x:Name="Fundgroup"/>
            </CollectionViewSource.GroupDescriptions>
        </CollectionViewSource>
        
        <ObjectDataProvider x:Key="tdlCatProvider" ObjectType="{x:Type System:Enum}" MethodName="GetValues">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="Model:tdlCat"/>
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>
        <ObjectDataProvider x:Key="fundCatProvider" ObjectType="{x:Type System:Enum}" MethodName="GetValues">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="Model:fundCat"/>
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>

        <Style x:Key="BarChart" TargetType="DVC:Chart">
            <Setter Property="Background" Value="{StaticResource ChartBackground}"/>
            <Setter Property="MinHeight" Value="500"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="DVC:Chart">
                        <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}"
                                        Padding="{TemplateBinding Padding}">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <Visualization:Title Style="{StaticResource LineChartTitle}" Content="{TemplateBinding Title}"/>
                                <Grid Grid.Row="1" Margin="0,15,0,15">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <Primitives:EdgePanel x:Name="ChartArea" Style="{TemplateBinding ChartAreaStyle}"/>
                                    <Visualization:Legend x:Name="Legend" Style="{TemplateBinding LegendStyle}" Grid.Row="1"/>
                                    <ComboBox x:Name="CategoryPick" Grid.Row="2" Background="#FF3A3838" BorderBrush="Black" Width="100" HorizontalAlignment="Left" BorderThickness="1" 
                                              ItemsSource="{Binding Source={StaticResource tdlCatProvider}}" SelectionChanged="CategoryPick_SelectionChanged" SelectedItem="{Binding SelectedCat}" >
                                    </ComboBox>
                                </Grid>
                            </Grid>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

    </Window.Resources>

    <Window.CommandBindings>
        <CommandBinding Command="Save" Executed="SaveCommand_Executed"/>
        <CommandBinding Command="SaveAs" Executed="SaveAsCommand_Executed"/>
        <CommandBinding Command="Open" Executed="OpenCommand_Executed"/>
    </Window.CommandBindings>

    <Grid Background="{StaticResource StandardBackground}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="311*"/>
            <ColumnDefinition Width="449*"/>
        </Grid.ColumnDefinitions>
        <Menu Style="{StaticResource StandardMenu}" Grid.ColumnSpan="2">
            <MenuItem Template="{DynamicResource MenuItemControlTemplate1}" Header="File">
                <MenuItem Header="New" />
                <MenuItem Command="Open"/>
                <MenuItem Command="Save"/>
                <MenuItem Command="SaveAs"/>
            </MenuItem>
        </Menu>
        <TabControl x:Name="FundingTabControl" Grid.Row="1" Background="{StaticResource StandardBackground}"  BorderBrush="Transparent" Grid.ColumnSpan="2">
            <TabItem Header="Dashboard" Style="{StaticResource TabItemTemplate}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <ScrollViewer VerticalAlignment="Stretch" Foreground="#FF1CCD0B">
                        <Grid Background="{StaticResource StandardBackground}">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Expander Grid.Row="1">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <StackPanel Orientation="Vertical">
                                        <Label Content="Project Funding" FontSize="16" Foreground="White" Background="Transparent"/>
                                        <TreeView   x:Name="TrackedMIPRdisplay" Background="Transparent" Visibility="Visible" AlternationCount="2" BorderBrush="Transparent"
                                                ItemsSource="{Binding TrackedMIPR}" ScrollViewer.VerticalScrollBarVisibility="Auto" Margin="10,5,5,5" SelectedItemChanged="TrackedMIPRdisplay_SelectedItemChanged">
                                            <TreeView.ItemContainerStyle>
                                                <Style TargetType="{x:Type TreeViewItem}">
                                                    <Setter Property="IsExpanded" Value="{Binding IsExpanded, Mode=TwoWay}"/>
                                                    <Setter Property="FontSize" Value="14" />
                                                    <Setter Property="FontFamily" Value="Segoe UI"/>
                                                    <Setter Property="Background" Value="Transparent"/>
                                                    <Setter Property="Foreground" Value="White"/>
                                                    <Setter Property="IsSelected" Value="{Binding SelectedMIPR}"/>
                                                    <Style.Triggers>
                                                        <Trigger Property="IsSelected" Value="True">
                                                            <Setter Property="FontWeight" Value="Bold"/>
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TreeView.ItemContainerStyle>
                                            <TreeView.ItemTemplate>
                                                <HierarchicalDataTemplate ItemsSource="{Binding Children}" x:Name="ProjNumTreelist">
                                                    <StackPanel Orientation="Horizontal">
                                                        <TextBlock Text="{Binding MIPRnum}"/>
                                                    </StackPanel>
                                                    <HierarchicalDataTemplate.ItemTemplate>
                                                        <DataTemplate>
                                                            <StackPanel Orientation="Horizontal">
                                                                <TextBlock Text="{Binding Projnum}"/>
                                                            </StackPanel>
                                                        </DataTemplate>
                                                    </HierarchicalDataTemplate.ItemTemplate>
                                                </HierarchicalDataTemplate>
                                            </TreeView.ItemTemplate>
                                        </TreeView>
                                    </StackPanel>

                                    <StackPanel Orientation="Vertical" Grid.Column="1" Grid.ColumnSpan="6">
                                    <Label Content="Funding Details" FontSize="16" Foreground="White" Background="Transparent" BorderBrush="White" BorderThickness="0,0,0,1" />
                                        <StackPanel Orientation="Horizontal" Grid.ColumnSpan="6">
                                    <ListBox Name="DBMIPRfunddetails1"     
                                        BorderBrush="Transparent"
                                        Background="Transparent"
                                        Foreground="White"
                                        FontSize="12"                                               
                                        DataContext="{Binding ElementName=TrackedMIPRdisplay, Path=SelectedItem}"
                                        >
                                        <TextBlock Text="{Binding MIPRnum, StringFormat= MIPR Number: {0}}"/>
                                        <TextBlock Text="{Binding Projnum, StringFormat= Project Number: {0}}"/>
                                        <TextBlock Text="{Binding BillingElem, StringFormat= Billing Element: {0}}"/>
                                        <TextBlock Text="{Binding Appn, StringFormat= Appn: {0}}"/>
                                        <TextBlock Text="{Binding AppnNo, StringFormat= Appn No: {0}}"/>
                                        <TextBlock Text="{Binding Program, StringFormat= Program: {0}}"/>
                                        <TextBlock Text="{Binding Sponsor, StringFormat= Sponsor: {0}}"/>
                                        <TextBlock Text="{Binding WCD, StringFormat= Work Completion Date: {0}, Converter={StaticResource DateConverter}}"/>
                                        <TextBlock Text="{Binding AppnExp, StringFormat= Appn Expiration: {0}, Converter={StaticResource DateConverter}}"/>
                                        <TextBlock Text="{Binding AcceptDate, StringFormat= Acceptance Date: {0}, Converter={StaticResource DateConverter}}"/>
                                    </ListBox>
                                    <ListBox Name="DBMIPRfunddetails2" 
                                                BorderBrush="Transparent"
                                                Background="Transparent"
                                                Foreground="White"
                                                FontSize="12"    
                                                DataContext="{Binding ElementName=TrackedMIPRdisplay, Path=SelectedItem}"       
                                                >
                                        <TextBlock Text="{Binding LabAlloc, StringFormat= Project Labor Allocated: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding MatAlloc, StringFormat= Project Material Allocated: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding TrvAlloc, StringFormat= Project Travel Allocated: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding SvcAlloc, StringFormat= Project Services Allocated: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding DivAlloc, StringFormat= Project Division Allocated: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding CBAlloc, StringFormat= Project Charge Back Allocated: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding OtherAlloc, StringFormat= Project Other Allocated: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding TotalAlloc, StringFormat= Project Total Allocated: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                    </ListBox>
                                    <ListBox Name="DBMIPRfunddetails3"   
                                                BorderBrush="Transparent"
                                                Background="Transparent"
                                                Foreground="White"
                                                FontSize="12"    
                                                DataContext="{Binding ElementName=TrackedMIPRdisplay, Path=SelectedItem}"       
                                                >
                                        <TextBlock Text="{Binding LabExp, StringFormat= Project Labor Expended: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding MatExp, StringFormat= Project Material Expended: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding TrvExp, StringFormat= Project Travel Expended: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding SvcExp, StringFormat= Project Services Expended: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding DivExp, StringFormat= Project Division Expended: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding CBExp, StringFormat= Project Charge Back Expended: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding OtherExp, StringFormat= Project Other Expended: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding TotalExp, StringFormat= Project Total Expended: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                    </ListBox>
                                    <ListBox Name="DBMIPRfunddetails4" 
                                                BorderBrush="Transparent"
                                                Background="Transparent"
                                                Foreground="White"
                                                FontSize="12"    
                                                DataContext="{Binding ElementName=TrackedMIPRdisplay, Path=SelectedItem}"    
                                                >
                                        <TextBlock Text="{Binding LabBal, StringFormat= Project Labor Balance: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding MatBal, StringFormat= Project Material Balance: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding TrvBal, StringFormat= Project Travel Balance: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding SvcBal, StringFormat= Project Services Balance: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding DivBal, StringFormat= Project Division Balance: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding CBBal, StringFormat= Project Charge Back Balance: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding OtherBal, StringFormat= Project Other Balance: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding TotalBal, StringFormat= Project Total Balance: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                    </ListBox>
                                        </StackPanel>
                                        <DVC:Chart x:Name="MIPRSnapChart" Margin="10,5,5,5" Style="{StaticResource MIPRsnapChart}" PlotAreaStyle="{StaticResource LineChartPlotArea}" 
                                        LegendStyle="{StaticResource ChartLegend}" TitleStyle="{StaticResource LineChartTitle}" Background="#FF3A3838" Padding="25,20,25,5" 
                                        >
                                            <DVC:Chart.Axes>
                                                <DVC:LinearAxis AxisLabelStyle="{StaticResource LineChartAxisLabel}" Orientation="Y" ShowGridLines="True" ExtendRangeToOrigin="True" Minimum="0"/>
                                                <DVC:CategoryAxis AxisLabelStyle="{StaticResource TDLChartAxisLabel}" Orientation="X" ShowGridLines="True"/>
                                            </DVC:Chart.Axes>

                                            <DVC:ColumnSeries x:Name="FundSeriesAllocated" ItemsSource ="{Binding FundingFunded}"  IndependentValuePath="Key" DependentValuePath="Value" 
                                                  DataPointStyle="{StaticResource BudgetColumns}" Title="Allocated" LegendItemStyle="{StaticResource BudgetTDLLegendItem}" Background="{StaticResource Brush1}"/>
                                            <DVC:ColumnSeries x:Name="FundSeriesExp" ItemsSource="{Binding FundingExpended}" IndependentValuePath="Key" DependentValuePath="Value"
                                                  DataPointStyle="{StaticResource FundedColumns}" Title="Expended" LegendItemStyle="{StaticResource FundedTDLLegendItem}" Background="{StaticResource Brush2}" />
                                            <DVC:ColumnSeries x:Name="FundSeriesBal" ItemsSource="{Binding FundingBalance}" IndependentValuePath="Key" DependentValuePath="Value"
                                                  DataPointStyle="{StaticResource ExpendedColumns}" Title="Balance" LegendItemStyle="{StaticResource ExpendedTDLLegendItem}" Background="{StaticResource Brush3}"/>
                                        </DVC:Chart>
                                    </StackPanel>
                                   


                                </Grid>
                            </Expander>
                            <DVC:Chart x:Name="TDLChart" Margin="10,5,5,5" Style="{StaticResource BarChart}" PlotAreaStyle="{StaticResource LineChartPlotArea}" 
                                        LegendStyle="{StaticResource ChartLegend}" TitleStyle="{StaticResource LineChartTitle}" Background="#FF3A3838" Padding="25,20,25,5" Grid.Row="2"
                                        >
                                <DVC:Chart.Axes>
                                    <DVC:LinearAxis AxisLabelStyle="{StaticResource LineChartAxisLabel}" Orientation="Y" ShowGridLines="True" ExtendRangeToOrigin="True" Minimum="0"/>
                                    <DVC:CategoryAxis AxisLabelStyle="{StaticResource TDLChartAxisLabel}" Orientation="X" ShowGridLines="True"/>
                                </DVC:Chart.Axes>

                                <DVC:ColumnSeries x:Name="TDLSeriesBudg" ItemsSource ="{Binding Budget}"  IndependentValuePath="Key" DependentValuePath="Value" 
                                                  DataPointStyle="{StaticResource BudgetColumns}" Title="Budget" LegendItemStyle="{StaticResource BudgetTDLLegendItem}" Background="{StaticResource Brush2}"/>
                                <DVC:ColumnSeries x:Name="TDLSeriesFund" ItemsSource="{Binding Funded}" IndependentValuePath="Key" DependentValuePath="Value"
                                                  DataPointStyle="{StaticResource FundedColumns}" Title="Funded" LegendItemStyle="{StaticResource FundedTDLLegendItem}" Background="{StaticResource TDLfund}" />
                                <DVC:ColumnSeries x:Name="TDLSeriesExp" ItemsSource="{Binding Expended}" IndependentValuePath="Key" DependentValuePath="Value"
                                                  DataPointStyle="{StaticResource ExpendedColumns}" Title="Expended" LegendItemStyle="{StaticResource ExpendedTDLLegendItem}" Background="{StaticResource Brush6}"/>
                                <DVC:ColumnSeries x:Name="TDLSeriesFundBal" ItemsSource="{Binding FundBalance}" IndependentValuePath="Key" DependentValuePath="Value"
                                                  DataPointStyle="{StaticResource FundBalanceColumns}" Title="Funding Balance" LegendItemStyle="{StaticResource FundedBalTDLLegendItem}" Background="#FF2AFDFD"/>
                                <DVC:ColumnSeries x:Name="TDLSeriesBudgBal" ItemsSource="{Binding BudgetBalance}" IndependentValuePath="Key" DependentValuePath="Value"
                                                  DataPointStyle="{StaticResource BudgBalanceColumns}" Title="Budget Balance" LegendItemStyle="{StaticResource BudgetBalTDLLegendItem}" Background="#FFBA2AFD"/>
                            </DVC:Chart>
                            <Expander Grid.Row="3">
                                <StackPanel Orientation="Horizontal">
                                    <ListBox Name="TDLselection" 
                                    Grid.Row="1"
                                    Background="#FF3A3838"
                                    Margin="10,0,5,5"
                                    BorderBrush="Black"
                                    BorderThickness="1,1,0,1"
                                    Foreground="FloralWhite"
                                    ItemsSource="{Binding TrackedTDLs}" 
                                    DisplayMemberPath="TDL_No"
                                    ItemContainerStyle="{StaticResource MIPRselector}"
                                    SelectedItem="{Binding SelectedTDL}"
                                    SelectionChanged="CategoryPick_SelectionChanged"
                                    >
                                    </ListBox>
                                    <ListBox Name="TDLdetails1" 
                                        Grid.Row="1"
                                        Grid.Column="1"
                                        Background="#FF3A3838"
                                        Margin="-6,0,5,5"
                                        BorderBrush="Black"
                                        BorderThickness="0,1,0,1"
                                        Foreground="FloralWhite"
                                        FontSize="14"    
                                        DataContext="{Binding ElementName=TDLselection, Path=SelectedItem}"           
                                    >
                                        <TextBlock Text="{Binding Contract, StringFormat= Contract: {0}}"/>
                                        <TextBlock Text="{Binding Description, StringFormat= Description: {0}}"/>
                                        <TextBlock Text="{Binding StartDate, StringFormat= Start Date: {0},Converter={StaticResource DateConverter}}"/>
                                        <TextBlock Text="{Binding CompDate, StringFormat= End Date: {0}, Converter={StaticResource DateConverter}}"/>
                                        <TextBlock Text="{Binding Engineer, StringFormat= Engineer: {0}}"/>
                                        <TextBlock Text="{Binding Subcontractor, StringFormat= Subcontractor: {0}}"/>
                                        <TextBlock Text="{Binding WeekEnding, StringFormat= Appn Expenditure Date: {0}, Converter={StaticResource DateConverter}}"/>
                                    </ListBox>
                                    <ListBox Name="TDLdetails2" 
                                        Grid.Row="1"
                                        Grid.Column="2"
                                        Background="#FF3A3838"
                                        Margin="-6,0,5,5"
                                        BorderBrush="Black"
                                        BorderThickness="0,1,0,1"
                                        Foreground="FloralWhite"
                                        FontSize="14"    
                                        DataContext="{Binding ElementName=TDLselection, Path=SelectedItem}"           
                                    >
                                        <TextBlock Text="{Binding BudgLab, StringFormat= Labor Budgeted: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding BudgTrv, StringFormat= Travel Budgeted: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding BudgMat, StringFormat= Material Budgeted: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding BudgOther, StringFormat= Other Budgeted: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding BudgTotal, StringFormat= Total Budgeted: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                    </ListBox>
                                    <ListBox Name="TDLdetails3"  
                                        Grid.Row="1"
                                        Grid.Column="3"
                                        Background="#FF3A3838"
                                        Margin="-6,0,5,5"
                                        BorderBrush="Black"
                                        BorderThickness="0,1,0,1"
                                        Foreground="FloralWhite"
                                        FontSize="14"    
                                        DataContext="{Binding ElementName=TDLselection, Path=SelectedItem}"           
                            >
                                        <TextBlock Text="{Binding FundLab, StringFormat= Labor Funded: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding FundTrv, StringFormat= Travel Funded: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding FundMat, StringFormat= Material Funded: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding FundOther, StringFormat= Other Funded: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding FundTotal, StringFormat= Total Funded: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                    </ListBox>
                                    <ListBox Name="TDLdetails4" 
                                        Grid.Row="1"
                                        Grid.Column="4" 
                                        Background="#FF3A3838"
                                        Margin="-6,0,5,5"
                                        BorderBrush="Black"
                                        BorderThickness="0,1,0,1"
                                        Foreground="FloralWhite"
                                        FontSize="14"    
                                        DataContext="{Binding ElementName=TDLselection, Path=SelectedItem}"           
                            >
                                        <TextBlock Text="{Binding ExpLab, StringFormat= Labor Expended: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding ExpTrv, StringFormat= Travel Expended: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding ExpMat, StringFormat= Material Expended: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding ExpOther, StringFormat= Other Expended: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding ExpTotal, StringFormat= Total Expended: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                    </ListBox>
                                    <ListBox Name="TDLdetails5" 
                                        Grid.Row="1"
                                        Grid.Column="5" 
                                        Background="#FF3A3838"
                                        Margin="-6,0,5,5"
                                        BorderBrush="Black"
                                        BorderThickness="0,1,1,1"
                                        Foreground="FloralWhite"
                                        FontSize="14"    
                                        DataContext="{Binding ElementName=TDLselection, Path=SelectedItem}"           
                            >
                                        <TextBlock Text="{Binding BudgBalLab, StringFormat= Labor Budget Balance: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding BudgBalTrv, StringFormat= Travel Budget Balance: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding BudgBalMat, StringFormat= Material Budget Balance:: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding BudgBalOther, StringFormat= Other Budget Balance: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding BudgBalTotal, StringFormat= Total Budget Balance:: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                    </ListBox>
                                    <ListBox Name="TDLdetails6" 
                                        Grid.Row="1"
                                        Grid.Column="6" 
                                        Background="#FF3A3838"
                                        Margin="-6,0,5,5"
                                        BorderBrush="Black"
                                        BorderThickness="0,1,1,1"
                                        Foreground="FloralWhite"
                                        FontSize="14"    
                                        DataContext="{Binding ElementName=TDLselection, Path=SelectedItem}"           
                            >
                                        <TextBlock Text="{Binding FundBalLab, StringFormat= Labor Funding Balance: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding FundBalTrv, StringFormat= Travel Funding Balance: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding FundBalMat, StringFormat= Material Funding Balance:: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding FundBalOther, StringFormat= Other Funding Balance: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                        <TextBlock Text="{Binding FundBalTotal, StringFormat= Total Funding Balance:: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                    </ListBox>
                                </StackPanel>
                            </Expander>
                        </Grid>
                    </ScrollViewer>
                </Grid>
            </TabItem>

            <TabItem Header="Funding" Style="{StaticResource TabItemTemplate}">
                <ScrollViewer>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel Orientation="Vertical" Margin="10,5,5,0">
                            <Label Content="Select Engineer:" Foreground="White" />
                            <ListBox x:Name="FundEngList" ItemsSource="{Binding EngineerList}" Style="{StaticResource TDLlist}"/>
                        </StackPanel>
                        <StackPanel Orientation="Vertical" Grid.Column="1" Margin="15,5,5,0">
                            <Label Content="Select Date Parameters:" Foreground="White"/>
                            <CheckBox x:Name="FundCurrentCheck" Content="Active MIPR Only"  Margin="0,20,0,0" VerticalContentAlignment="Center" TextBlock.Foreground="White"
                                  Click="FundCurrentCheck_Click"/>
                            <CheckBox x:Name="FundCustomDateCheck" Content="Filter by WCD" TextBlock.Foreground="White" Margin="0,20,0,0" VerticalContentAlignment="Center"
                                  Click="FundCustomDateCheck_Click"/>
                            <Label Content="Select MIPR WCD:" Foreground="White" Margin="0,20,0,0"/>
                            <DatePicker x:Name="WCDPick" Margin="0,20,0,0"/>
                        </StackPanel>
                        <StackPanel Orientation="Vertical" Grid.Column="2" Margin="15,5,5,0">
                            <Label Content="Select MIPR:" Foreground="White"/>
                            <ListBox x:Name="MIPRList"  Style="{StaticResource TDLlist}" ItemsSource="{Binding miprsum}" DisplayMemberPath="MIPRnum"  SelectionMode="Single"/>
                        </StackPanel>
                        <StackPanel Orientation="Vertical" Grid.Column="3" Margin="15,5,5,0">
                            <Label Content="Select Project Number:" Foreground="White" />
                            <ListBox x:Name="ProjNumList"  Style="{StaticResource TDLlist}" ItemsSource="{Binding ProjNumList}" DisplayMemberPath="Projnum" SelectionMode="Extended"/>
                        </StackPanel>
                        <StackPanel Orientation="Vertical" Grid.Column="4" Margin="15,5,5,0">
                            <Label Content="Command Menu" Foreground="White" HorizontalContentAlignment="Center"/>
                            <Button x:Name="EngFilter" Content="Show MIPR"  Style="{StaticResource TDLButton}" MaxHeight="50"  MaxWidth="200" Click="MIPRFilter_Click"/>
                            <Button x:Name="Show_Nums_Button" Content="Show Project Number"  Style="{StaticResource TDLButton}" MaxHeight="50" MaxWidth="200" Click="Show_Nums_Button_Click"/>
                            <Button x:Name="Track_Nums_Button" Content="Track Project Number"  Style="{StaticResource TDLButton}" MaxHeight="50" MaxWidth="200" Click="Track_Nums_Button_Click"/>
                            <Button x:Name="Fund_Reset_Param_Button" Content="Reset Parameters"  Style="{StaticResource TDLButton}" MaxHeight="50" MaxWidth="200" Click="Fund_Reset_Param_Button_Click"/>
                            <Button x:Name="Clear_Nums_Button" Content="Clear Tracked"  Style="{StaticResource TDLButton}" MaxHeight="50" MaxWidth="200"/>
                        </StackPanel>
                        <Grid Grid.Row="1" Grid.ColumnSpan="5">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Label Content="MIPR Details" FontSize="16" Foreground="White" Background="Transparent" BorderBrush="White" BorderThickness="0,0,0,1" Grid.ColumnSpan="5"/>
                            <ListBox Name="MIPRfunddetails1"     
                            BorderBrush="Transparent"
                            Background="Transparent"
                            Foreground="White"
                            FontSize="12"                  
                            Grid.Row="1"
                            DataContext="{Binding ElementName=MIPRList, Path=SelectedItem}"
                            >
                                <TextBlock Text="{Binding MIPRnum, StringFormat= MIPR Number: {0}}"/>
                                <TextBlock Text="{Binding BillingElem, StringFormat= Billing Element: {0}}"/>
                                <TextBlock Text="{Binding Appn, StringFormat= Appn: {0}}"/>
                                <TextBlock Text="{Binding AppnNo, StringFormat= Appn No: {0}}"/>
                                <TextBlock Text="{Binding Program, StringFormat= Program: {0}}"/>
                                <TextBlock Text="{Binding Sponsor, StringFormat= Sponsor: {0}}"/>
                                <TextBlock Text="{Binding WCD, StringFormat= Work Completion Date: {0}, Converter={StaticResource DateConverter}}"/>
                                <TextBlock Text="{Binding AppnExp, StringFormat= Appn Expiration: {0}, Converter={StaticResource DateConverter}}"/>
                                <TextBlock Text="{Binding AcceptDate, StringFormat= Acceptance Date: {0}, Converter={StaticResource DateConverter}}"/>
                            </ListBox>
                            <ListBox Name="MIPRfunddetails2" 
                            BorderBrush="Transparent"
                            Background="Transparent"
                            Foreground="White"
                            FontSize="12"    
                            Grid.Row="1"
                            Grid.Column="1"
                            DataContext="{Binding ElementName=MIPRList, Path=SelectedItem}"       
                            >
                                <TextBlock Text="{Binding LabAlloc, StringFormat= Labor Allocated: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                <TextBlock Text="{Binding MatAlloc, StringFormat= Material Allocated: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                <TextBlock Text="{Binding TrvAlloc, StringFormat= Travel Allocated: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                <TextBlock Text="{Binding SvcAlloc, StringFormat= Services Allocated: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                <TextBlock Text="{Binding DivAlloc, StringFormat= Division Allocated: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                <TextBlock Text="{Binding CBAlloc, StringFormat= Charge Back Allocated: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                <TextBlock Text="{Binding OtherAlloc, StringFormat= Other Allocated: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                <TextBlock Text="{Binding TotalAlloc, StringFormat= Total Allocated: {0}, Converter={StaticResource CurrencyConverter}}"/>
                            </ListBox>
                            <ListBox Name="MIPRfunddetails3"   
                            BorderBrush="Transparent"
                            Background="Transparent"
                            Foreground="White"
                            FontSize="12"    
                            Grid.Row="1"
                            Grid.Column="2"
                            DataContext="{Binding ElementName=MIPRList, Path=SelectedItem}"       
                            >
                                <TextBlock Text="{Binding LabExp, StringFormat= Labor Expended: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                <TextBlock Text="{Binding MatExp, StringFormat= Material Expended: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                <TextBlock Text="{Binding TrvExp, StringFormat= Travel Expended: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                <TextBlock Text="{Binding SvcExp, StringFormat= Services Expended: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                <TextBlock Text="{Binding DivExp, StringFormat= Division Expended: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                <TextBlock Text="{Binding CBExp, StringFormat= Charge Back Expended: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                <TextBlock Text="{Binding OtherExp, StringFormat= Other Expended: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                <TextBlock Text="{Binding TotalExp, StringFormat= Total Expended: {0}, Converter={StaticResource CurrencyConverter}}"/>
                            </ListBox>
                            <ListBox Name="MIPRfunddetails4" 
                            BorderBrush="Transparent"
                            Background="Transparent"
                            Foreground="White"
                            FontSize="12"    
                            Grid.Row="1"
                            Grid.Column="3"
                            DataContext="{Binding ElementName=MIPRList, Path=SelectedItem}"    
                            >
                                <TextBlock Text="{Binding LabBal, StringFormat= Labor Balance: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                <TextBlock Text="{Binding MatBal, StringFormat= Material Balance: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                <TextBlock Text="{Binding TrvBal, StringFormat= Travel Balance: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                <TextBlock Text="{Binding SvcBal, StringFormat= Services Balance: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                <TextBlock Text="{Binding DivBal, StringFormat= Division Balance: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                <TextBlock Text="{Binding CBBal, StringFormat= Charge Back Balance: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                <TextBlock Text="{Binding OtherBal, StringFormat= Other Balance: {0}, Converter={StaticResource CurrencyConverter}}"/>
                                <TextBlock Text="{Binding TotalBal, StringFormat= Total Balance: {0}, Converter={StaticResource CurrencyConverter}}"/>
                            </ListBox>

                            <Label Content="Project Number Details" FontSize="16" Foreground="White" Background="Transparent" BorderBrush="White" BorderThickness="0,0,0,1" Grid.ColumnSpan="5" Grid.Row="2"/>
                            <ListBox  BorderBrush="Transparent"
                            Background="Transparent"
                            Foreground="White"
                            FontSize="12"             
                            Grid.Row="3"
                            DataContext="{Binding ElementName=ProjNumList, Path=SelectedItem}">
                                <TextBlock Text="{Binding Projnum, StringFormat= Project Number: {0}}"/>
                                <TextBlock Text="{Binding BillingElem, StringFormat= Billing Element: {0}}"/>
                                <TextBlock Text="{Binding Network , StringFormat= Network: {0}}"/>
                                <TextBlock Text="{Binding Activity, StringFormat= Activity: {0}}"/>
                                <TextBlock Text="{Binding ActElem, StringFormat= Sub Elem: {0}}"/>
                                <TextBlock Text="{Binding Appn, StringFormat= Appn: {0}}"/>
                                <TextBlock Text="{Binding AppnNo, StringFormat= AppnNo: {0}}"/>
                                <TextBlock Text="{Binding DocType, StringFormat= Doc Type: {0}}"/>
                            </ListBox>
                            <ListBox  BorderBrush="Transparent"
                            Background="Transparent"
                            Foreground="White"
                            FontSize="12"                  
                            Grid.Row="3"
                            Grid.Column="1"
                            DataContext="{Binding ElementName=ProjNumList, Path=SelectedItem}">
                                <TextBlock Text="{Binding Program, StringFormat= Program: {0}}"/>
                                <TextBlock Text="{Binding Project, StringFormat= Project: {0}}"/>
                                <TextBlock Text="{Binding Title, StringFormat= Title: {0}}"/>
                                <TextBlock Text="{Binding Sponsor, StringFormat= Sponsor: {0}}"/>
                                <TextBlock Text="{Binding Engineer, StringFormat= Engineer: {0}}"/>
                                <TextBlock Text="{Binding WCD, StringFormat= WCD: {0}}"/>
                                <TextBlock Text="{Binding AppnExp, StringFormat= APPN Expiration: {0}}"/>
                                <TextBlock Text="{Binding AcceptDate, StringFormat= Accept Date: {0}}"/>
                            </ListBox>
                            <ListBox  BorderBrush="Transparent"
                            Background="Transparent"
                            Foreground="White"
                            FontSize="12"         
                            Grid.Row="3"
                            Grid.Column="2"
                            DataContext="{Binding ElementName=ProjNumList, Path=SelectedItem}">
                                <TextBlock Text="{Binding LabAlloc, StringFormat= Labor Allocated {0}}"/>
                                <TextBlock Text="{Binding MatAlloc, StringFormat= Material Allocated: {0}}"/>
                                <TextBlock Text="{Binding TrvAlloc, StringFormat= Travel Allocated: {0}}"/>
                                <TextBlock Text="{Binding SvcAlloc , StringFormat= Services Allocated: {0}}"/>
                                <TextBlock Text="{Binding DivAlloc , StringFormat= Division Allocated: {0}}"/>
                                <TextBlock Text="{Binding CBAlloc, StringFormat= CB Allocated: {0}}"/>
                                <TextBlock Text="{Binding OtherAlloc, StringFormat= Other Allocated: {0}}"/>
                                <TextBlock Text="{Binding TotalAlloc, StringFormat= Total Allocated: {0}}"/>
                            </ListBox>
                            <ListBox  BorderBrush="Transparent"
                            Background="Transparent"
                            Foreground="White"
                            FontSize="12"                  
                            Grid.Row="3"
                            Grid.Column="3"
                            DataContext="{Binding ElementName=ProjNumList, Path=SelectedItem}">
                                <TextBlock Text="{Binding LabExp, StringFormat= Labor Expended: {0}}"/>
                                <TextBlock Text="{Binding MatExp, StringFormat= Material Expended: {0}}"/>
                                <TextBlock Text="{Binding TrvExp, StringFormat= Travel Expended: {0}}"/>
                                <TextBlock Text="{Binding SvcExp, StringFormat= Services Expended: {0}}"/>
                                <TextBlock Text="{Binding DivExp, StringFormat= Division Expended: {0}}"/>
                                <TextBlock Text="{Binding CBExp, StringFormat= CB Expended: {0}}"/>
                                <TextBlock Text="{Binding OtherExp, StringFormat= Other Expended: {0}}"/>
                                <TextBlock Text="{Binding TotalExp, StringFormat= Total Expended: {0}}"/>
                            </ListBox>
                            <ListBox  BorderBrush="Transparent"
                            Background="Transparent"
                            Foreground="White"
                            FontSize="12"             
                            Grid.Row="3"
                            Grid.Column="4"
                            DataContext="{Binding ElementName=ProjNumList, Path=SelectedItem}">
                                <TextBlock Text="{Binding LabBal, StringFormat= Labor Balance: {0}}"/>
                                <TextBlock Text="{Binding MatBal, StringFormat= Material Balance: {0}}"/>
                                <TextBlock Text="{Binding TrvBal, StringFormat= Travel Balance: {0}}"/>
                                <TextBlock Text="{Binding SvcBal, StringFormat= Services Balance: {0}}"/>
                                <TextBlock Text="{Binding DivBal, StringFormat= Division Balance: {0}}"/>
                                <TextBlock Text="{Binding CBBal, StringFormat= CB Balance: {0}}"/>
                                <TextBlock Text="{Binding OtherBal, StringFormat= Other Balance: {0}}"/>
                                <TextBlock Text="{Binding TotalBal, StringFormat= Total Balance: {0}}"/>
                            </ListBox>
                        </Grid>
                        <Label Content="Tracked Funding" FontSize="16" Foreground="White" Background="Transparent" BorderBrush="White" BorderThickness="0,0,0,1" Grid.ColumnSpan="5" Grid.Row="2" x:Name="TrackedFunds"
                           Visibility="Hidden" Margin="0,0,0,10"/>
                        <DataGrid x:Name="FundsGrid"  
                              Background="Transparent" 
                              BorderBrush="Transparent" 
                              AutoGenerateColumns="False" 
                              ItemsSource="{Binding Source={StaticResource cvFundData}}"
                              Visibility="Hidden" 
                              Grid.Row ="3" 
                              Grid.ColumnSpan="5"          
                              RowBackground="Transparent"
                              CanUserReorderColumns="True"
                              CanUserResizeColumns="True"
                              CanUserSortColumns="True" 
                              CanUserResizeRows="True"
                              IsReadOnly="True"
                              GridLinesVisibility="All"
                              HorizontalGridLinesBrush="White"
                              >
                            <DataGrid.GroupStyle>
                                <GroupStyle>
                                    <GroupStyle.ContainerStyle>
                                        <Style TargetType="{x:Type GroupItem}">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="{x:Type GroupItem}">
                                                        <Expander IsExpanded="False" Background="Transparent" Foreground="White" Header="{Binding Path=Name}" FontSize="15" >
                                                            <Expander.Content>
                                                                <ItemsPresenter/>
                                                            </Expander.Content>
                                                        </Expander>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </GroupStyle.ContainerStyle>
                                </GroupStyle>
                            </DataGrid.GroupStyle>
                            <DataGrid.Resources>
                                <Style TargetType="{x:Type DataGridColumnHeader}">
                                    <Setter Property="Background" Value="Transparent"/>
                                    <Setter Property="Foreground" Value="White"/>
                                    <Setter Property="FontSize" Value="15" />
                                    <Setter Property="FontFamily" Value="Segoe UI"/>
                                    <Setter Property="BorderBrush" Value="White"/>
                                    <Setter Property="Margin" Value="0,0,15,0"/>
                                </Style>
                            </DataGrid.Resources>
                            <DataGrid.Columns>
                                <DataGridTemplateColumn Header="Project Number">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding Projnum}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Billing Element">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding BillingElem}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Network">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding Network}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Activity">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding Activity}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Sub Element">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding ActElem}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="APPN">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding Appn}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="APPN No.">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding AppnNo}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Doc Type">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding DocType}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Program">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding Program}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Project">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding Project}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Title">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding Title}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Sponsor">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding Sponsor}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Engineer">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding Engineer}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Labor Allocated">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding LabAlloc}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Material Allocated">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding MatAlloc}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Travel Allocated">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding TrvAlloc}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Services Allocated">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding SvcAlloc}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Division Allocated">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding DivAlloc}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="CB Allocated">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding CBAlloc}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Other Allocated">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding OtherAlloc}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Total Allocated">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding TotalAlloc}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Labor Expended">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding LabExp}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Material Expended">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding MatExp}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Travel Expended">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding TrvExp}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Services Expended">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding SvcExp}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Division Expended">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding DivExp}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="CB Expended">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding CBExp}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Other Expended">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding OtherExp}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Total Expended">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding TotalExp}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Labor Balance">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding LabBal}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Material Balance">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding MatBal}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Travel Balance">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding TrvBal}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Services Balance">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding SvcBal}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Division Balance">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding DivBal}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="CB Balance">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding CBBal}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Other Balance">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding OtherBal}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Total Balance">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding TotalBal}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="WCD">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding WCD}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="APPN Expiration">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding AppnExp}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Acceptance Date">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding AcceptDate}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </ScrollViewer>
            </TabItem>
            
            <TabItem Header="Project Funding" Style="{StaticResource TabItemTemplate}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Orientation="Horizontal">
                        <TextBox Name="SearchBox" TextWrapping="Wrap" MaxLines="25" MinWidth="200" Margin="10,5,5,5" Background="White" Foreground="Black"
                         Text="Enter Search Criteria" FontSize="14" HorizontalContentAlignment="Left" VerticalContentAlignment="Center"/>
                        <Button Style="{StaticResource DefaultButtonStyle}" BorderThickness="1" Click="GetData_Click" Cursor="Hand">Query</Button>
                        <Button Style="{StaticResource DefaultButtonStyle}" BorderThickness="1" Cursor="Hand" Click="Clear_Click">Clear</Button>
                        <Button Style="{StaticResource DefaultButtonStyle}" BorderThickness="1" Cursor="Hand" Click="TrackFunding_Click">Add Funding</Button>
                        <Button Style="{StaticResource DefaultButtonStyle}" BorderThickness="1" Cursor="Hand" Click="UpdateButton_Click">Update Funding</Button>
                        <Button Style="{StaticResource DefaultButtonStyle}" BorderThickness="1" Cursor="Hand" Click="ShowTree_Click">Show Visual Tree</Button>
                    </StackPanel>
                    <Grid Grid.Row="1">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="AUTO"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <GridSplitter Grid.Column="1" Width="3" HorizontalAlignment="Center" Grid.Row="1" Margin="0,0,5,0" Background="DodgerBlue"/>
                        <TreeView Name="FundingDisplay" Background="Transparent" BorderBrush="Transparent"  Visibility="Hidden" AlternationCount="2" 
                        ItemsSource="{Binding MIPRnums}" ScrollViewer.VerticalScrollBarVisibility="Auto" Margin="10,5,5,5" Grid.Row="1">
                            <TreeView.ItemContainerStyle>
                                <Style TargetType="{x:Type TreeViewItem}">
                                    <Setter Property="IsExpanded" Value="{Binding IsExpanded, Mode=TwoWay}"/>
                                    <Setter Property="IsSelected" Value="{Binding IsSelected, Mode=TwoWay}"/>
                                    <Setter Property="FontSize" Value="14" />
                                    <Setter Property="FontFamily" Value="Segoe UI"/>
                                    <Setter Property="Background" Value="Transparent"/>
                                    <Setter Property="Foreground" Value="AntiqueWhite"/>
                                    <Style.Triggers>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter Property="FontWeight" Value="Bold"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </TreeView.ItemContainerStyle>
                            <TreeView.ItemTemplate>
                                <HierarchicalDataTemplate ItemsSource="{Binding MIPRchildren}">
                                    <StackPanel Orientation="Horizontal">
                                        <CheckBox IsChecked="{Binding IsChecked}"/>
                                        <TextBlock Text="{Binding MIPRName}"/>
                                    </StackPanel>
                                    <HierarchicalDataTemplate.ItemTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <CheckBox IsChecked="{Binding IsChecked}"/>
                                                <TextBlock Text="{Binding ProjNum}" MouseLeftButtonDown="ProjectNumberSelected" />
                                            </StackPanel>
                                        </DataTemplate>
                                    </HierarchicalDataTemplate.ItemTemplate>
                                </HierarchicalDataTemplate>
                            </TreeView.ItemTemplate>
                        </TreeView>
                        <Popup Name="ProjectNumPopup" StaysOpen="False" Placement="MousePoint" PopupAnimation="Fade" AllowsTransparency="True">
                            <ListBox Name="DetailsList" Margin="5" Style="{StaticResource ProjectNumberList}" 
                             DataContext="{Binding ElementName=MIPRdisplay, Path=SelectedItem}" BorderBrush="#FF423B3B">
                                <TextBlock Text="{Binding Children[0], StringFormat= Billing Element: {0}}"/>
                                <TextBlock Text="{Binding Children[1], StringFormat= Network: {0}}"/>
                                <TextBlock Text="{Binding Children[2], StringFormat= Activity: {0}}"/>
                                <TextBlock Text="{Binding Children[3], StringFormat= Sub Elem: {0}}"/>
                                <TextBlock Text="{Binding Children[4], StringFormat= Appn: {0}}"/>
                                <TextBlock Text="{Binding Children[5], StringFormat= AppnNo: {0}}"/>
                                <TextBlock Text="{Binding Children[6], StringFormat= Doc Type: {0}}"/>
                                <TextBlock Text="{Binding Children[7], StringFormat= Program: {0}}"/>
                                <TextBlock Text="{Binding Children[8], StringFormat= Project: {0}}"/>
                                <TextBlock Text="{Binding Children[9], StringFormat= Title: {0}}"/>
                                <TextBlock Text="{Binding Children[10], StringFormat= Sponsor: {0}}"/>
                                <TextBlock Text="{Binding Children[11], StringFormat= Engineer: {0}}"/>
                                <TextBlock Text="{Binding Children[12], StringFormat= Labor Allocated {0}}"/>
                                <TextBlock Text="{Binding Children[13], StringFormat= Material Allocated: {0}}"/>
                                <TextBlock Text="{Binding Children[14], StringFormat= Travel Allocated: {0}}"/>
                                <TextBlock Text="{Binding Children[15], StringFormat= Services Allocated: {0}}"/>
                                <TextBlock Text="{Binding Children[16], StringFormat= Division Allocated: {0}}"/>
                                <TextBlock Text="{Binding Children[17], StringFormat= CB Allocated: {0}}"/>
                                <TextBlock Text="{Binding Children[18], StringFormat= Other Allocated: {0}}"/>
                                <TextBlock Text="{Binding Children[19], StringFormat= Total Allocated: {0}}"/>
                                <TextBlock Text="{Binding Children[20], StringFormat= Labor Expended: {0}}"/>
                                <TextBlock Text="{Binding Children[21], StringFormat= Material Expended: {0}}"/>
                                <TextBlock Text="{Binding Children[22], StringFormat= Travel Expended: {0}}"/>
                                <TextBlock Text="{Binding Children[23], StringFormat= Services Expended: {0}}"/>
                                <TextBlock Text="{Binding Children[24], StringFormat= Division Expended: {0}}"/>
                                <TextBlock Text="{Binding Children[25], StringFormat= CB Expended: {0}}"/>
                                <TextBlock Text="{Binding Children[26], StringFormat= Other Expended: {0}}"/>
                                <TextBlock Text="{Binding Children[27], StringFormat= Total Expended: {0}}"/>
                                <TextBlock Text="{Binding Children[28], StringFormat= Labor Balance: {0}}"/>
                                <TextBlock Text="{Binding Children[29], StringFormat= Material Balance: {0}}"/>
                                <TextBlock Text="{Binding Children[30], StringFormat= Travel Balance: {0}}"/>
                                <TextBlock Text="{Binding Children[31], StringFormat= Services Balance: {0}}"/>
                                <TextBlock Text="{Binding Children[32], StringFormat= Division Balance: {0}}"/>
                                <TextBlock Text="{Binding Children[33], StringFormat= CB Balance: {0}}"/>
                                <TextBlock Text="{Binding Children[34], StringFormat= Other Balance: {0}}"/>
                                <TextBlock Text="{Binding Children[35], StringFormat= Total Balance: {0}}"/>
                                <TextBlock Text="{Binding Children[36], StringFormat= WCD: {0}}"/>
                                <TextBlock Text="{Binding Children[37], StringFormat= APPN Expiration: {0}}"/>
                                <TextBlock Text="{Binding Children[38], StringFormat= Accept Date: {0}}"/>
                            </ListBox>
                        </Popup>
                        <DataGrid x:Name="FundingGrid"  
                              Background="Transparent" 
                              BorderBrush="Transparent" 
                              AutoGenerateColumns="False" 
                              ItemsSource="{Binding Source={StaticResource cvGridData}}"
                              Visibility="Hidden" 
                              Grid.Row ="1" 
                              Grid.Column="2" 
                              Margin="0,5,5,5" 
                              AlternatingRowBackground="LightBlue"
                              CanUserReorderColumns="True"
                              CanUserResizeColumns="True"
                              CanUserSortColumns="True" 
                              CanUserResizeRows="True"
                              IsReadOnly="True"
                              >
                            <DataGrid.GroupStyle>
                                <GroupStyle>
                                    <GroupStyle.ContainerStyle>
                                        <Style TargetType="{x:Type GroupItem}">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="{x:Type GroupItem}">
                                                        <Expander IsExpanded="False" Background="LightBlue" Foreground="Black" Header="{Binding Path=Name}" BorderBrush="White" BorderThickness="0,0,0,0" FontSize="15" >
                                                            <Expander.Content>
                                                                <ItemsPresenter/>
                                                            </Expander.Content>
                                                        </Expander>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </GroupStyle.ContainerStyle>
                                </GroupStyle>
                            </DataGrid.GroupStyle>
                            <DataGrid.Resources>
                                <Style TargetType="{x:Type DataGridColumnHeader}">
                                    <Setter Property="Background" Value="Transparent"/>
                                    <Setter Property="Foreground" Value="White"/>
                                    <Setter Property="FontSize" Value="12" />
                                    <Setter Property="FontFamily" Value="Segoe UI"/>
                                    <Setter Property="Margin" Value="10,5,5,5"/>
                                </Style>
                            </DataGrid.Resources>
                            <DataGrid.Columns>
                                <DataGridTemplateColumn Header="MIPR Number">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding MIPRnum}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Project Number">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding ProjNum}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Billing Element">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding BillingElem}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Network">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding Network}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Activity">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding Activity}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Sub Element">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding SubElem}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="APPN">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding Appn}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="APPN No.">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding AppnNo}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Doc Type">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding DocType}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Program">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding Program}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Project">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding Project}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Title">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding Title}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Sponsor">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding Sponsor}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Engineer">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding Engineer}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Labor Allocated">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding LabAlloc}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Material Allocated">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding MatAlloc}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Travel Allocated">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding TrvAlloc}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Services Allocated">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding SvcAlloc}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Division Allocated">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding DivAlloc}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="CB Allocated">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding CBAlloc}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Other Allocated">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding OtherAlloc}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Total Allocated">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding TotalAlloc}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Labor Expended">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding LabExp}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Material Expended">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding MatExp}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Travel Expended">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding TrvExp}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Services Expended">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding SvcExp}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Division Expended">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding DivExp}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="CB Expended">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding CBExp}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Other Expended">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding OtherExp}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Total Expended">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding TotalExp}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Labor Balance">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding LabBal}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Material Balance">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding MatBal}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Travel Balance">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding TrvBal}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Services Balance">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding SvcBal}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Division Balance">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding DivBal}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="CB Balance">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding CBBal}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Other Balance">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding OtherBal}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Total Balance">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding TotalBal}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="WCD">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding WCD}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="APPN Expiration">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding AppnExp}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Acceptance Date">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DataGridCell>
                                                <TextBlock Text="{Binding AcceptDate}" Style="{StaticResource NormalText}"/>
                                            </DataGridCell>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Grid>
            </TabItem>
            
            <TabItem Header="Service Contract Tasks" Style="{StaticResource TabItemTemplate}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Orientation="Vertical" Margin="10,5,5,0">
                        <Label Content="Select Engineer:" Foreground="White" />
                        <ListBox x:Name="EngList" ItemsSource="{Binding EngineerList}" Style="{StaticResource TDLlist}"/>
                    </StackPanel>
                    <StackPanel Orientation="Vertical" Grid.Column="1" Margin="15,5,5,0">
                        <Label Content="Select Contract:" Foreground="White"/>
                        <ListBox x:Name="ContractList" ItemsSource="{Binding ContractList}" Style="{StaticResource TDLlist}"/>
                    </StackPanel>
                    <StackPanel Orientation="Vertical" Grid.Column="2" Margin="15,5,5,0">
                        <Label Content="Select Date Parameters:" Foreground="White"/>
                        <CheckBox x:Name="CurrentCheck" Content="Use Current Tasking"  Margin="0,20,0,0" VerticalContentAlignment="Center" TextBlock.Foreground="White"
                                  Click="CurrentCheck_Click"/>
                        <CheckBox x:Name="CustomDateCheck" Content="Custom Date Range" TextBlock.Foreground="White" Margin="0,20,0,0" VerticalContentAlignment="Center"
                                  Click="CustomDateCheck_Click" Unchecked="CustomDateCheck_Unchecked"/>
                        <Label Content="Select Task Start Date:" Foreground="White" Margin="0,20,0,0"/>
                        <DatePicker x:Name="StartDatePick" Margin="0,20,0,0"/>
                        <Label Content="Select Task End Date:" Foreground="White" Margin="0,20,0,0"/>
                        <DatePicker x:Name="EndDatePick" Margin="0,20,0,0"/>
                    </StackPanel>
                    <StackPanel Orientation="Vertical" Grid.Column="3" Margin="15,5,5,0">
                        <Label Content="Select Task:" Foreground="White" />
                        <ListBox x:Name="TaskList"  Style="{StaticResource TDLlist}" ItemsSource="{Binding filteredTDLs}" DisplayMemberPath="TDL_No"/>
                    </StackPanel>
                    <StackPanel Orientation="Vertical" Grid.Column="4" Margin="15,5,50,0" Height="375">
                        <Label Content="Command Menu" Foreground="White" HorizontalContentAlignment="Center"/>
                        <Button Content="Filter Tasks"  Style="{StaticResource TDLButton}" Click="Filter_Button_Click" MaxWidth="200"/>
                        <Button x:Name="Reset_Param_Button" Content="Reset Parameters"  Style="{StaticResource TDLButton}" Click="Reset_Param_Button_Click"  />
                        <Button x:Name="Track_Tasks_Button" Content="Track Tasks"  Style="{StaticResource TDLButton}" Click="Track_Tasks_Button_Click" MaxWidth="200"/>
                        <Button x:Name="Clear_Tasks_Button" Content="Clear Tracked Tasks"  Style="{StaticResource TDLButton}" Click="Clear_Tasks_Button_Click" MaxWidth="200"/>
                    </StackPanel>
                    <GridSplitter Height="3" Grid.Row="1" Grid.ColumnSpan="5" Background="DodgerBlue" HorizontalAlignment="Stretch" Padding="0" Margin="0,0,0,0" BorderBrush="Transparent"/>
                    <DataGrid x:Name="TDLGrid"  
                              Background="Transparent" 
                              BorderBrush="Transparent" 
                              AutoGenerateColumns="False" 
                              ItemsSource="{Binding Source={StaticResource cvTDLData}}"
                              Visibility="Hidden" 
                              Grid.Row ="3" 
                              Grid.ColumnSpan="5"
                              Margin="0,5,5,5"                        
                              RowBackground="Transparent"
                              CanUserReorderColumns="True"
                              CanUserResizeColumns="True"
                              CanUserSortColumns="True" 
                              CanUserResizeRows="True"
                              IsReadOnly="True"
                              GridLinesVisibility="All"
                              HorizontalGridLinesBrush="White"
                              >
                        <DataGrid.GroupStyle>
                            <GroupStyle>
                                <GroupStyle.ContainerStyle>
                                    <Style TargetType="{x:Type GroupItem}">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="{x:Type GroupItem}">
                                                    <Expander IsExpanded="False" Background="Transparent" Foreground="White" Header="{Binding Path=Name}" FontSize="15" >
                                                        <Expander.Content>
                                                            <ItemsPresenter/>
                                                        </Expander.Content>
                                                    </Expander>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </GroupStyle.ContainerStyle>
                            </GroupStyle>
                        </DataGrid.GroupStyle>
                        <DataGrid.Resources>
                            <Style TargetType="{x:Type DataGridColumnHeader}">
                                <Setter Property="Background" Value="Transparent"/>
                                <Setter Property="Foreground" Value="White"/>
                                <Setter Property="FontSize" Value="15" />
                                <Setter Property="FontFamily" Value="Segoe UI"/>
                                <Setter Property="BorderBrush" Value="White"/>
                                <Setter Property="Margin" Value="0,0,15,0"/>
                            </Style>
                        </DataGrid.Resources>
                        <DataGrid.Columns>
                            <DataGridTemplateColumn Header="Task Number">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding TDL_No}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Contract No.">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding Contract}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Description">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding Description}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Start Date">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding StartDate}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="End Date">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding CompDate}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Engineer">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding Engineer}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Subcontractor">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding Subcontractor}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Expenditure Date">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding WeekEnding}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Budget Hours">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding BudgHrs}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Budget Labor">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding BudgLab, Converter={StaticResource CurrencyConverter}}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Budget Travel">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding BudgTrv, Converter={StaticResource CurrencyConverter}}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Budget Material">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding BudgMat, Converter={StaticResource CurrencyConverter}}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Budget Other">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding BudgOther, Converter={StaticResource CurrencyConverter}}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Budget Total">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding BudgTotal, Converter={StaticResource CurrencyConverter}}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Funded Labor">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding FundLab, Converter={StaticResource CurrencyConverter}}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Funded Travel">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding FundTrv, Converter={StaticResource CurrencyConverter}}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Funded Material">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding FundMat, Converter={StaticResource CurrencyConverter}}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Funded Other">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding FundOther, Converter={StaticResource CurrencyConverter}}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Funded Total">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding FundTotal, Converter={StaticResource CurrencyConverter}}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Expended Hours">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding ExpHours}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Expended Labor">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding ExpLab, Converter={StaticResource CurrencyConverter}}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Expended Travel">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding ExpTrv, Converter={StaticResource CurrencyConverter}}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Expended Material">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding ExpMat, Converter={StaticResource CurrencyConverter}}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Expended Other">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding ExpOther, Converter={StaticResource CurrencyConverter}}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Expended Total">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding ExpTotal, Converter={StaticResource CurrencyConverter}}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Budget Balance Hours">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding BudgBalHrs, Converter={StaticResource CurrencyConverter}}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Budget Balance Labor">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding BudgBalLab, Converter={StaticResource CurrencyConverter}}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Budget Balance Travel">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding BudgBalTrv, Converter={StaticResource CurrencyConverter}}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Budget Balance Material">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding BudgBalMat, Converter={StaticResource CurrencyConverter}}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Budget Balance Other">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding BudgBalOther, Converter={StaticResource CurrencyConverter}}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Budget Balance Total">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding BudgBalTotal, Converter={StaticResource CurrencyConverter}}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Funding Balance Labor">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding FundBalLab, Converter={StaticResource CurrencyConverter}}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Funding Balance Travel">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding FundBalTrv, Converter={StaticResource CurrencyConverter}}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Funding Balance Material">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding FundBalMat, Converter={StaticResource CurrencyConverter}}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Funding Balance Other">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding FundBalOther, Converter={StaticResource CurrencyConverter}}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Funding Balance Total">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <DataGridCell>
                                            <TextBlock Text="{Binding FundBalTotal, Converter={StaticResource CurrencyConverter}}" Style="{StaticResource TDLText}"/>
                                        </DataGridCell>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>
            
        </TabControl>
    </Grid>

</Window>
